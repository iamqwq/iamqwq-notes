# Understanding Networks - 理解网络

## 0 在所有话之前

理解整个计算机网络里里外外的细节以及原理是困难的，尤其是在刚接触学习的人来说，" 从何处入手 "、" 如何理解庞大的计算机网络知识 " 就成为了最大的问题。

因此在开始总结我所学之内容前，我首先就这两个问题作回答。

就如很多其它计算机领域用到的思想一样，计算机网络中也用到了 " 对上隐藏实现细节 " 这一基本设计思想。从网络组成中最不抽象的物理设备和通信原理入手，对于对网络整体的运作方式的理解毫无帮助，这会使得学习网络原理一事变得犹如西西弗斯必须永远推那巨石爬上山顶——好像充满了苦难和悲壮感一样。

我需要声明一点：我没有收广告费。但是我必须推荐一本书，《计算机网络：自顶向下方法》。

就算刨去这本书内容不谈，就其这本书的内容结构的设计而言，无疑也是极具启发意义的。首先从最高的角度俯瞰网络结构，先理解最抽象的部分，然后逐个把抽象的内容具体化解释。易于理解，而且不会产生枯燥感。

本网络原理的笔记大部分精简和总结自这本书，由于网络技术和设备更新迭代的问题，文章不可避免的存在时效性的问题，此处注明落笔时间为 2023 年，参考的《计算机网络：自顶向下方法》为第七版。

## 1 理解 " 网络 "

" 网络 "，我们的软件赖以实现远程通信的核心关键。" 网络 " 的原理好像深不可测，它究竟是如何实现远程通信的呢？

我们很少对日常用语的每个字的字面义进行思考。" 网络 " 的原理就是其字面义本身，让我们思考一张网：组成网的要素无非是网络边缘的端点、端点与端点之间组成的路径、路径与路径相交而成的中间节点。

我们明确一下组成 " 网络 " 的组成要素：

1. 端点
2. 路径
3. 中间节点

我们或许说的是现实世界中的蜘蛛网，但计算机 " 网络 " 同样是这个原理，远程通信无非是从一个设备发送信号到另一个设备，设备之间由某种方式连接（有时是光纤，有时是双绞线，有时设备也通过无线接发设备来获取和发送信号）。

再进一步解释 " 网络 " 的组成要素：

1. 端点 - 终端设备：这些设备即是网络的最终用户所使用的设备（例如笔记本或手机），终端设备也可以看作为小型的子网，子网将在后文介绍。
2. 路径 - 通信介质：可以简单理解为用于传输数据的介质。
3. 中间节点 - 通信转发和交换设备：见名知意，它们负责数据的寻址和转发（即将数据发送到正确的方向）。

## 2 局域网与互联网

什么样的结构在网络中才算子网络？显然，任何端点数不小于二的端点及其路径加起来就是一个子网络，换言之，即是只要复数的计算机能够进行通讯的网络就算一张子网络。

在这节之前我们以较大的角度概括网络结构，如果进一步概括计算机网络的构成，即是数量巨大的子网通过通信转发和交换设备相互连接而组成又一个巨大的子网络，巨大的子网络又互相连接.. 以此类推。

子网络分为不同种类，但他们的分类对我们的宏观理解帮助不大，而他们的区别却仅限于覆盖范围（分类繁多，一般分类有 WAN RAN MAN CAN LAN PAN BAN Nano ）。因此接下来仅介绍局域网（ LAN ），随后介绍局域网的互相组合而组成的互联网。

### 2. 1 局域网

比如最简单的网络就是两台计算机（下图中为 PC 1 与 PC 2）通过可以互相传递数据的物理介质（下图中为ethernet cable，即为网线）连接起来，并且在计算机中安装可以处理这些数据接收和发送方式等等的网络控制软件，这样两台计算机就可以共享各种计算机资源了。这种情况我们可以说这两台计算机在局部区域组成了一个网络，这个网络即为一个 **local area network（局域网，即为LAN）**，一般我们的家庭网络也是一个局域网。

![202206231149send-request-3x](Understanding%20Networks%20-%20%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C.assets/202206231149send-request-3x.png)

### 2. 2 互联网

**互联网**，就是将这些局域网连接起来，这种将局域网连接的工程十分庞大，一般由 ISP （互联网服务提供商）负责这些工作。

我们先从较为抽象的层面介绍互联网与局域网的关系：

![202206231053send-request-3x.excalidraw.excalidraw](Understanding%20Networks%20-%20%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C.assets/202206231053send-request-3x.excalidraw.excalidraw.png)

如上图所示，这里把发送请求的设备称之为 client（客户端），处理请求和回送请求的称之为 server（服务端）。而互联网的作用就是 forward（转发）这些请求，并设法将从 client 与 server 之间找出一条可行的路径将这些请求送到。

我们会发现上述的转发这一过程**抽象掉了互联网中的送信过程**。

![202206231118send-request-3x](Understanding%20Networks%20-%20%E7%90%86%E8%A7%A3%E7%BD%91%E7%BB%9C.assets/202206231118send-request-3x-1678599488576.png)

上图是一个模拟互联网的模型，我们来解析这个请求传递的细节。

我们知道发起请求的客户端是身处一个局域网中，就像在家庭中的一台设备一样，它的请求如果想要传递给与客户端身处不同局域网的服务端，就需要将请求交由互联网中的转发设备（将图中的圆形视为转发设备）进行转发，将请求送到服务端所在的局域网。通过上图可以发现，转发的设备所在的网络也并不是身处同一个单一的网络，通常是经过多个大型的网络互相转发直到目标局域网。

可以注意到，无论是 client 还是 server 都处于整个网络的最边缘，所以称其为 terminal（端，或称终端），而这个转发设备通常为 router（路由器）以及 link-layer switch （链路层交换机），他们都负责将数据朝着最终目的地转发。

在大致整理了上述概念后，我们可以通过简单的一句话来理解互联网。**互联网就是网络（各个局域网）的网络**。